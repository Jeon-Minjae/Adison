<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fuel Kiosk</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            background: #f4f4f4; 
            padding: 20px;
        }
        .page { 
            display: none; 
            padding: 20px; 
            max-width: 400px; /* Narrower width for kiosk vertical layout */
            margin: 0 auto; /* Center content */
        }
        button {
            padding: 15px 25px;
            margin: 10px 0; /* Vertical margin only */
            font-size: 20px;
            border-radius: 10px;
            border: none;
            background: #007bff;
            color: white;
            cursor: pointer;
            width: 100%; /* Full width buttons for vertical layout */
            box-sizing: border-box;
        }
        button:hover { background: #0059c9; }
        input { 
            padding: 10px; 
            font-size: 18px; 
            margin: 10px 0; /* Vertical margin */
            width: 100%; /* Full width input */
            box-sizing: border-box;
        }
        .amount-container {
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <!-- PAGE 1: Fuel Selection with Amount Input -->
    <div id="page1" class="page" style="display:block;">
        <h2>Select Your Fuel Type</h2>
        
        <!-- New: Amount input section -->
        <div class="amount-container">
            <label for="fuelAmount" style="font-size: 18px;">Enter Fuel Amount (RM):</label>
            <input type="number" id="fuelAmount" placeholder="e.g., 50" min="1" step="1" required>
        </div>
        
        <!-- Buttons arranged vertically -->
        <button onclick="goPayment('RON95')">RON 95</button>
        <button onclick="goPayment('RON97')">RON 97</button>
        <button onclick="goPayment('Diesel')">Diesel</button>
    </div>

    <!-- PAGE 2: Payment Method -->
    <div id="page2" class="page">
        <h2>Payment Method</h2>
        <h3 id="fuelDisplay"></h3> <!-- Will show fuel type and amount -->
        <button onclick="payCounter()">Pay at Counter</button>
        <button onclick="payCard()">Pay by Card</button>
        <button onclick="payEwallet()">Pay by E-Wallet</button>
    </div>

    <!-- PAGE 3: Ask Digital Receipt -->
    <div id="page3" class="page">
        <h2>Do you want a digital receipt?</h2>
        <button onclick="yesReceipt()">Yes</button>
        <button onclick="noReceipt()">No</button>
    </div>

    <!-- PAGE 4: Phone Number Input -->
    <div id="page4" class="page">
        <h2>Enter Your Phone Number</h2>
        <p>Malaysia format only</p>
        <input type="text" id="phone" placeholder="01X-XXXXXXX">
        <br>
        <button onclick="submitPhone()">Submit</button>
        <p id="error" style="color:red;"></p>
    </div>

    <!-- PAGE 5: Pump Assignment -->
    <div id="page5" class="page">
        <h2>Payment Complete</h2>
        <h3 id="pumpInfo"></h3>
        <p>Please proceed to the assigned pump.</p>
    </div>

    <script>
        // Track selected fuel and amount
        let fuelSelected = "";
        let fuelAmount = 0;
        // Demo pump assignment
        let availablePump = 3;

        function show(page){
            document.querySelectorAll('.page').forEach(p => p.style.display = "none");
            document.getElementById(page).style.display = "block";
        }

        function goPayment(fuel){
            // Get and validate amount input
            const amountInput = document.getElementById("fuelAmount");
            fuelAmount = parseFloat(amountInput.value);
            
            // Validate amount
            if (isNaN(fuelAmount) || fuelAmount < 1) {
                alert("Please enter a valid fuel amount (minimum RM1)");
                return; // Stay on page1 if invalid
            }
            
            fuelSelected = fuel;
            // Update display to show both fuel type and amount
            document.getElementById("fuelDisplay").innerText = 
                `Selected: ${fuel} - RM${fuelAmount.toFixed(2)}`;
            show("page2");
        }

        function payCounter(){
            alert(`Please proceed to the counter to pay RM${fuelAmount.toFixed(2)}.`);
            assignPump();
        }

        function payCard(){
            alert(`Please tap or insert your card to pay RM${fuelAmount.toFixed(2)}.`);
            show("page3");
        }

        function payEwallet(){
            alert(`Please wave or scan your QR / e-wallet to pay RM${fuelAmount.toFixed(2)}.`);
            show("page3");
        }

        function yesReceipt(){
            show("page4");
        }

        function noReceipt(){
            assignPump();
        }

        function submitPhone(){
            let phone = document.getElementById("phone").value;
            const error = document.getElementById("error");

            error.innerText = "";

            if (!phone.trim()) {
                error.innerText = "Phone number cannot be empty.";
                return;
            }

            phone = phone.replace(/\D/g, "");
            const regex = /^(011\d{8}|01[0-46-9]\d{7})$/;

            if(!regex.test(phone)){
                error.innerText = "Invalid Malaysia phone number format (e.g., 012-3456789).";
                return;
            }

            alert(`Digital receipt for RM${fuelAmount.toFixed(2)} will be sent!`);
            assignPump();
        }

        function assignPump(){
            document.getElementById("pumpInfo").innerText = 
                `Please go to Pump ${availablePump} to fuel up (RM${fuelAmount.toFixed(2)}).`;
            show("page5");
        }
    </script>
</body>
</html>

